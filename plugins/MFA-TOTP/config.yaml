id: MFATOTP
name: MFA-TOTP
version: 1.0.0

description: <__trans phrase="This plugin enables multi factor authentication by RFC6238 OTP.">
author_link: http://www.movabletype.org/
author_name: Six Apart Ltd.

l10n_lexicon:
  ja:
    This plugin enables multi factor authentication by RFC6238 OTP.: "認証デバイスによる多要素認証の機能を有効にします"
    Configuring the authentication device: "認証デバイスの設定"
    "Scan the QR code to register your account with your authentication device and enter the [_1]-digit security token displayed.": "QRコードをスキャンして認証デバイスにアカウントを登録し、表示された[_1]桁の認証コードを入力してください。"
    "Enter the [_1]-digit security token displayed on your authentication device.": "認証デバイスに表示された[_1]桁の確認コードを入力してください。"
    "Are you sure you want to close the modal window, although the configuration of the authentication device is not complete?": "認証デバイスの設定は完了していませんが、モーダルウィンドウを閉じてもよろしいですか？"
    Security token does not match.: "確認コードが一致しません。"
    Security token: "確認コード"
    The setup is complete.: "設定が完了しました。"
    "If you lose access to your authentication device, you can use the following recovery code to authenticate.": "認証デバイスにアクセスできなくなった場合には、以下のリカバリーコードを使って認証することができます。"
    Download recovery codes: "リカバリーコードをダウンロード"
    This account already has an authentication device associated with it.: "このアカウントにはすでに認証デバイスが設定されています"
    'To delete a setting, enter the security token displayed on your authentication device and click the "Delete" button.': "設定を削除する場合には、認証デバイスに表示された認証コードを入力して「削除」ボタンをクリックしてください。"
    "Configuration data prior to version 1.0 of MFA-TOTP has been deleted. Please set up the authentication device again after the upgrade.": "MFA-TOTPのバージョン1.0より前の設定データを削除しています。アップグレードの後に再度認証デバイスの設定を行ってください。"

settings:
  totp_digits:
    scope: system
    default: 6
  totp_tolerance:
    scope: system
    default: 1
  recovery_code_length:
    scope: system
    default: 8
  recovery_code_count:
    scope: system
    default: 8

schema_version: 0.02
object_types:
  author:
    mfa_totp_base32_secret: string(255) meta
    mfa_totp_recovery_codes: array meta

upgrade_functions:
  reset_totp_001_metadata:
    version_limit: 0.02
    updater:
      label: Configuration data prior to version 1.0 of MFA-TOTP has been deleted. Please set up the authentication device again after the upgrade.
      type: author
      sql: DELETE FROM mt_author_meta WHERE author_meta_type LIKE 'mfa_totp_%'

applications:
  cms:
    methods:
      mfa_totp_dialog: $MFATOTP::MT::Plugin::MFA::TOTP::dialog
      mfa_totp_enable:
        handler: $MFATOTP::MT::Plugin::MFA::TOTP::enable
        app_mode: JSON
      mfa_totp_disable:
        handler: $MFATOTP::MT::Plugin::MFA::TOTP::disable
        app_mode: JSON

callbacks:
  mfa_page_actions: $MFATOTP::MT::Plugin::MFA::TOTP::page_actions
  mfa_reset_settings: $MFATOTP::MT::Plugin::MFA::TOTP::reset_settings
  mfa_render_form: $MFATOTP::MT::Plugin::MFA::TOTP::render_form
  mfa_verify_token: $MFATOTP::MT::Plugin::MFA::TOTP::verify_token
